#Load EEG Data
EEG_v1 <- read.csv("E:\\EEG Data\\Behavioural Data\\Original Data\\extracted_data_300-400_v1.csv")
EEG_v2 <- read.csv("E:\\EEG Data\\Behavioural Data\\Original Data\\extracted_data_300-400_v2.csv")
EEG_v3 <- read.csv("E:\\EEG Data\\Behavioural Data\\Original Data\\extracted_data_300-400_v3.csv")
# #Combine EEG Data
combined_EEG <- bind_rows(EEG_v1, EEG_v2, EEG_v3)
##############
combined_EEG <- combined_EEG %>%
mutate(
cond = case_when(
Condition == 1 ~ -1,
Condition == 2 ~ -1,
Condition == 3 ~ 1,
Condition == 4 ~ 1
),
trial_type = case_when(
Condition == 1 ~ 1,
Condition == 2 ~ -1,
Condition == 3 ~ 1,
Condition == 4 ~ -1
)
)
# Load necessary libraries
library(tidyverse)
library(nlme)
library(dplyr)
library(ggplot2)
#Load EEG Data
EEG_v1 <- read.csv("E:\\EEG Data\\Behavioural Data\\Original Data\\extracted_data_300-400_v1.csv")
EEG_v2 <- read.csv("E:\\EEG Data\\Behavioural Data\\Original Data\\extracted_data_300-400_v2.csv")
EEG_v3 <- read.csv("E:\\EEG Data\\Behavioural Data\\Original Data\\extracted_data_300-400_v3.csv")
# #Combine EEG Data
combined_EEG <- bind_rows(EEG_v1, EEG_v2, EEG_v3)
##############
combined_EEG <- combined_EEG %>%
mutate(
cond = case_when(
Condition == 1 ~ -1,
Condition == 2 ~ -1,
Condition == 3 ~ 1,
Condition == 4 ~ 1
),
trial_type = case_when(
Condition == 1 ~ 1,
Condition == 2 ~ -1,
Condition == 3 ~ 1,
Condition == 4 ~ -1
)
)
# Run ANOVA
ANOVA <- aov(Value ~ cond * trial_type + Error(Subject / (trial_type * cond)), data = combined_EEG)
summary(ANOVA)
# Run Regression
regression <- lme(Value ~ cond * trial_type, random = ~ 1 | Subject, data = combined_EEG)
summary(regression)
# Extract participant-level estimates
combined_EEG$fitted_values <- fitted(regression)
combined_EEG$residuals <- residuals(regression)
# Create spaghetti plot
ggplot(combined_EEG, aes(x = trial_type, y = Value, group = Subject)) +
geom_line(aes(y = fitted_values), color = "blue", alpha = 0.3) +
geom_point(color = "red", alpha = 0.6) +
labs(title = "Spaghetti Plot of Fitted Values by Subject",
x = "Trial Type",
y = "Value") +
theme_minimal()
#############Interaction Plot
ggplot(combined_EEG, aes(x = cond, y = Value, color = as.factor(trial_type), group = trial_type)) +
stat_summary(fun = mean, geom = "point", size = 3) +
stat_summary(fun = mean, geom = "line", aes(group = trial_type), linetype = "solid") +
stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0.3) +
labs(title = "Interaction Plot of Condition and Trial Type on Value",
x = "Condition", y = "Mean Value") +
scale_x_continuous(breaks = c(-1, 1), labels = c("oddball", "reversal")) +
scale_color_manual(values = c("-1" = "#800000", "1" = "#87CEEB"), labels = c("-1" = "rare", "1" = "common")) +
theme_minimal()
